<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lions Karate Club - Bill Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary: #1a365d;
            --primary-light: #2c5282;
            --secondary: #4a5568;
            --accent: #4299e1;
            --background: #f7fafc;
            --card-bg: #ffffff;
            --text: #2d3748;
            --text-light: #718096;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
        }
        
        .receipt-preview {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            background-color: var(--card-bg);
            border-radius: 0.5rem;
        }
        
        .striped-row:nth-child(even) {
            background-color: rgba(66, 153, 225, 0.05);
        }
        
        .no-print {
            display: none;
        }
        
        @media print {
            body * {
                visibility: hidden;
            }
            .receipt-preview, .receipt-preview * {
                visibility: visible;
            }
            .receipt-preview {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
        }
        
        /* Custom animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        
        .animate-slide-in {
            animation: slideIn 0.4s ease-out forwards;
        }
        
        .animate-pulse {
            animation: pulse 1.5s infinite;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* Karate belt colors */
        .belt-white { background-color: #ffffff; color: var(--text); border: 1px solid #e2e8f0; }
        .belt-yellow { background-color: #f6e05e; color: var(--text); }
        .belt-orange { background-color: #ed8936; color: white; }
        .belt-green { background-color: #48bb78; color: white; }
        .belt-blue { background-color: #4299e1; color: white; }
        .belt-purple { background-color: #9f7aea; color: white; }
        .belt-brown { background-color: #b7793f; color: white; }
        .belt-black { background-color: #1a202c; color: white; }
        
        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: 0.375rem;
            color: white;
            font-weight: 500;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .toast.success {
            background-color: #10b981;
        }
        
        .toast.error {
            background-color: #ef4444;
        }
        
        /* Loading spinner */
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Button hover effects */
        .btn-hover-effect {
            transition: all 0.3s ease;
            transform: translateY(0);
        }
        
        .btn-hover-effect:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        /* Input focus effect */
        .input-focus-effect:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        /* Mobile menu toggle */
        .mobile-menu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .mobile-menu.open {
            max-height: 500px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Toast Notification -->
    <div id="toast" class="toast hidden">
        <div class="flex items-center">
            <span id="toastMessage"></span>
        </div>
    </div>
    
    <div class="container mx-auto px-4 py-8">
        <!-- Mobile Header -->
        <div class="lg:hidden mb-6">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <div class="w-12 h-12 rounded-full bg-red-600 flex items-center justify-center shadow-lg mr-3">
                        <i class="fas fa-lion text-white text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">Lions Karate Club</h1>
                        <p class="text-xs text-gray-600">Pune, Maharashtra</p>
                    </div>
                </div>
                <button id="mobileMenuToggle" class="p-2 rounded-lg bg-gray-100 text-gray-700">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
            
            <!-- Mobile Menu -->
            <div id="mobileMenu" class="mobile-menu bg-white rounded-lg shadow-lg mt-3">
                <div class="p-4">
                    <div class="space-y-3 mb-4">
                        <button id="mobileMonthlyTab" class="w-full py-2 px-4 rounded-lg bg-gradient-to-r from-blue-600 to-blue-500 text-white font-medium transition duration-200 flex items-center justify-between">
                            <span><i class="fas fa-calendar-alt mr-2"></i> Monthly/Admission</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <button id="mobileExamTab" class="w-full py-2 px-4 rounded-lg bg-gray-100 text-gray-800 font-medium transition duration-200 flex items-center justify-between">
                            <span><i class="fas fa-medal mr-2"></i> Belt Exam Fee</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    
                    <div class="pt-4 border-t border-gray-200">
                        <h3 class="text-sm font-semibold mb-3 text-gray-800 flex items-center">
                            <i class="fas fa-info-circle mr-2 text-blue-600"></i> Club Info
                        </h3>
                        <div class="space-y-2 text-xs text-gray-600">
                            <p class="flex items-center">
                                <i class="fas fa-phone-alt mr-2 text-blue-500"></i> Phone: 9049688172
                            </p>
                            <p class="flex items-center">
                                <i class="fas fa-map-marker-alt mr-2 text-blue-500"></i> Pune, Maharashtra
                            </p>
                            <p class="flex items-center">
                                <i class="fas fa-clock mr-2 text-blue-500"></i> Mon-Sat: 6AM-9PM
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Desktop Header -->
        <header class="mb-8 text-center hidden lg:block">
            <div class="flex justify-center items-center mb-4">
                <div class="w-16 h-16 rounded-full bg-red-600 flex items-center justify-center shadow-lg animate-pulse">
                    <i class="fas fa-lion text-white text-3xl"></i>
                </div>
            </div>
            <h1 class="text-4xl font-bold text-gray-800 mb-2 animate-slide-in">Lions Karate Club</h1>
            <p class="text-xl text-gray-600 font-medium">Pune, Maharashtra</p>
            <p class="text-lg text-blue-600 font-medium">Registration No: PU000121240</p>
            <p class="text-lg text-blue-600 mt-2 font-medium">Bill Generator System</p>
        </header>
        
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Navigation Sidebar -->
            <div class="w-full lg:w-1/4 hidden lg:block">
                <div class="bg-white rounded-xl shadow-md p-6 sticky top-4 transition-all duration-200 hover:shadow-lg border border-gray-200">
                    <h2 class="text-xl font-semibold mb-6 text-gray-800 border-b pb-2 flex items-center">
                        <i class="fas fa-receipt mr-2 text-blue-600"></i> Receipt Types
                    </h2>
                    <div class="space-y-3">
                        <button id="monthlyTab" class="w-full py-3 px-4 rounded-lg bg-gradient-to-r from-blue-600 to-blue-500 text-white font-medium transition duration-200 hover:from-blue-700 hover:to-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 flex items-center justify-between btn-hover-effect">
                            <span><i class="fas fa-calendar-alt mr-2"></i> Monthly/Admission</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <button id="examTab" class="w-full py-3 px-4 rounded-lg bg-gray-100 text-gray-800 font-medium transition duration-200 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 flex items-center justify-between btn-hover-effect">
                            <span><i class="fas fa-medal mr-2"></i> Belt Exam Fee</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    
                    <div class="mt-8 pt-4 border-t border-gray-200">
                        <h3 class="text-lg font-semibold mb-3 text-gray-800 flex items-center">
                            <i class="fas fa-info-circle mr-2 text-blue-600"></i> Club Info
                        </h3>
                        <div class="space-y-2 text-sm text-gray-600">
                            <p class="flex items-center">
                                <i class="fas fa-phone-alt mr-2 text-blue-500"></i> Phone: 9049688172
                            </p>
                            <p class="flex items-center">
                                <i class="fas fa-map-marker-alt mr-2 text-blue-500"></i> Pune, Maharashtra
                            </p>
                            <p class="flex items-center">
                                <i class="fas fa-clock mr-2 text-blue-500"></i> Mon-Sat: 6AM-9PM
                            </p>
                        </div>
                    </div>
                    
                    <div class="mt-6 pt-4 border-t border-gray-200">
                        <h3 class="text-lg font-semibold mb-3 text-gray-800 flex items-center">
                            <i class="fas fa-calendar-check mr-2 text-blue-600"></i> Upcoming Exams
                        </h3>
                        <div id="upcomingExams" class="space-y-2 text-sm">
                            <p class="text-gray-500 italic">No upcoming exams scheduled</p>
                        </div>
                    </div>
                    
                    <div class="mt-6 pt-4 border-t border-gray-200">
                        <h3 class="text-lg font-semibold mb-3 text-gray-800 flex items-center">
                            <i class="fas fa-history mr-2 text-blue-600"></i> Recent Receipts
                        </h3>
                        <div id="recentReceipts" class="space-y-2 text-sm">
                            <p class="text-gray-500 italic">No recent receipts yet</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content Area -->
            <div class="w-full lg:w-3/4">
                <!-- Monthly/Admission Fee Form -->
                <div id="monthlyForm" class="bg-white rounded-xl shadow-sm p-6 mb-8 animate-fade-in border border-gray-200">
                    <div class="flex items-center mb-6">
                        <div class="p-3 rounded-lg bg-blue-100 text-blue-600 mr-4">
                            <i class="fas fa-calendar-alt text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-2xl font-bold text-gray-800">Monthly/Admission Fee</h2>
                            <p class="text-gray-600">Generate receipts for monthly fees and admissions</p>
                        </div>
                    </div>
                    
                    <form id="monthlyReceiptForm" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="studentName" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                                    <i class="fas fa-user mr-2 text-blue-500"></i> Student Name
                                </label>
                                <div class="relative">
                                    <input type="text" id="studentName" name="studentName" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 input-focus-effect text-gray-100 placeholder-gray-400" placeholder="Enter student name" required>
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-user text-gray-400"></i>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label for="receiptDate" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                                    <i class="fas fa-calendar-day mr-2 text-blue-500"></i> Date
                                </label>
                                <div class="relative">
                                    <input type="date" id="receiptDate" name="receiptDate" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 input-focus-effect" required>
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-calendar text-gray-400"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label for="monthlyFee" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                                    <i class="fas fa-rupee-sign mr-2 text-blue-500"></i> Monthly Fee (₹)
                                </label>
                                <div class="relative">
                                    <input type="number" id="monthlyFee" name="monthlyFee" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 input-focus-effect" value="0" min="0" placeholder="0.00">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <span class="text-gray-500">₹</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label for="admissionFee" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                                    <i class="fas fa-sign-in-alt mr-2 text-blue-500"></i> Admission Fee (₹)
                                </label>
                                <div class="relative">
                                    <input type="number" id="admissionFee" name="admissionFee" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 input-focus-effect" value="0" min="0" placeholder="0.00">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <span class="text-gray-500">₹</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label for="otherCharges" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                                    <i class="fas fa-plus-circle mr-2 text-blue-500"></i> Other Charges (₹)
                                </label>
                                <div class="relative">
                                    <input type="number" id="otherCharges" name="otherCharges" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 input-focus-effect" value="0" min="0" placeholder="0.00">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <span class="text-gray-500">₹</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <label for="notes" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                                <i class="fas fa-sticky-note mr-2 text-blue-500"></i> Notes
                            </label>
                            <textarea id="notes" name="notes" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-200 input-focus-effect" placeholder="Additional notes (optional)"></textarea>
                        </div>
                        
                        <div class="flex justify-end space-x-4 pt-2">
                            <button type="reset" class="px-6 py-3 bg-gray-700 text-gray-200 rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 transition duration-200 flex items-center btn-hover-effect">
                                <i class="fas fa-redo mr-2"></i> Reset
                            </button>
                            <button type="button" id="generateMonthlyReceipt" class="px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-lg hover:from-blue-700 hover:to-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition duration-200 flex items-center btn-hover-effect">
                                <i class="fas fa-file-invoice-dollar mr-2"></i> Generate Receipt
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Belt Exam Fee Form -->
                <div id="examForm" class="bg-white rounded-xl shadow-sm p-6 mb-8 hidden animate-fade-in border border-gray-200">
                    <div class="flex items-center mb-6">
                        <div class="p-3 rounded-lg bg-purple-100 text-purple-600 mr-4">
                            <i class="fas fa-medal text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-2xl font-bold text-gray-800">Belt Exam Fee</h2>
                            <p class="text-gray-600">Generate receipts for belt examination fees</p>
                        </div>
                    </div>
                    
                    <form id="examReceiptForm" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="examStudentName" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                                    <i class="fas fa-user mr-2 text-purple-500"></i> Student Name
                                </label>
                                <div class="relative">
                                    <input type="text" id="examStudentName" name="examStudentName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition duration-200 input-focus-effect" placeholder="Enter student name" required>
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-user text-gray-400"></i>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label for="examDate" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                                    <i class="fas fa-calendar-day mr-2 text-purple-500"></i> Exam Date
                                </label>
                                <div class="relative">
                                    <input type="date" id="examDate" name="examDate" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition duration-200 input-focus-effect" required>
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-calendar text-gray-400"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="appliedBelt" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                                    <i class="fas fa-belt mr-2 text-purple-500"></i> Applied Belt
                                </label>
                                <div class="relative">
                                    <select id="appliedBelt" name="appliedBelt" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition duration-200 appearance-none input-focus-effect">
                                        <option value="White Belt" class="belt-white">White Belt</option>
                                        <option value="Yellow Belt" class="belt-yellow">Yellow Belt</option>
                                        <option value="Orange Belt" class="belt-orange">Orange Belt</option>
                                        <option value="Green Belt" class="belt-green">Green Belt</option>
                                        <option value="Blue Belt" class="belt-blue">Blue Belt</option>
                                        <option value="Purple Belt" class="belt-purple">Purple Belt</option>
                                        <option value="Brown Belt" class="belt-brown">Brown Belt</option>
                                        <option value="Black Belt" class="belt-black">Black Belt</option>
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <i class="fas fa-chevron-down text-gray-400"></i>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label for="examFee" class="block text-sm font-medium text-gray-700 mb-2 flex items-center">
                                    <i class="fas fa-rupee-sign mr-2 text-purple-500"></i> Exam Fee (₹)
                                </label>
                                <div class="relative">
                                    <input type="number" id="examFee" name="examFee" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition duration-200 input-focus-effect" required min="0" placeholder="0.00">
                                    <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                                        <span class="text-gray-500">₹</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex justify-end space-x-4 pt-2">
                            <button type="reset" class="px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 transition duration-200 flex items-center btn-hover-effect">
                                <i class="fas fa-redo mr-2"></i> Reset
                            </button>
                            <button type="button" id="generateExamReceipt" class="px-6 py-3 bg-gradient-to-r from-purple-600 to-purple-500 text-white rounded-lg hover:from-purple-700 hover:to-purple-600 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 transition duration-200 flex items-center btn-hover-effect">
                                <i class="fas fa-file-invoice-dollar mr-2"></i> Generate Receipt
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Receipt Preview Section -->
                <div id="receiptPreviewSection" class="bg-white rounded-xl shadow-sm p-6 hidden animate-fade-in border border-gray-200">
                    <div class="flex justify-between items-center mb-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-lg bg-green-100 text-green-600 mr-4">
                                <i class="fas fa-file-invoice text-xl"></i>
                            </div>
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800">Receipt Preview</h2>
                                <p class="text-gray-600">Review before downloading</p>
                            </div>
                        </div>
                        <div class="flex space-x-3">
                            <button id="printReceipt" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 transition duration-200 flex items-center btn-hover-effect">
                                <i class="fas fa-print mr-2"></i> Print
                            </button>
                            <button id="downloadPdf" class="px-4 py-2 bg-gradient-to-r from-green-600 to-green-500 text-white rounded-lg hover:from-green-700 hover:to-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition duration-200 flex items-center btn-hover-effect">
                                <i class="fas fa-file-pdf mr-2"></i> Download PDF
                            </button>
                        </div>
                    </div>
                    
                    <div id="receiptPreview" class="receipt-preview bg-white p-6 rounded-lg border border-gray-200 text-gray-800">
                        <!-- Receipt content will be generated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize jsPDF
        const { jsPDF } = window.jspdf;
        
        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.className = 'toast hidden';
            }, 3000);
        }
        
        // Mobile menu toggle
        document.getElementById('mobileMenuToggle').addEventListener('click', function() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('open');
        });
        
        // Tab switching functionality
        function switchTab(tab) {
            if (tab === 'monthly') {
                document.getElementById('monthlyForm').classList.remove('hidden');
                document.getElementById('examForm').classList.add('hidden');
                document.getElementById('receiptPreviewSection').classList.add('hidden');
                
                document.getElementById('monthlyTab').classList.remove('bg-gray-100', 'text-gray-800');
                document.getElementById('monthlyTab').classList.add('bg-gradient-to-r', 'from-blue-600', 'to-blue-500', 'text-white');
                
                document.getElementById('examTab').classList.remove('bg-gradient-to-r', 'from-purple-600', 'to-purple-500', 'text-white');
                document.getElementById('examTab').classList.add('bg-gray-100', 'text-gray-800');
                
                // For mobile
                document.getElementById('mobileMonthlyTab').classList.remove('bg-gray-100', 'text-gray-800');
                document.getElementById('mobileMonthlyTab').classList.add('bg-gradient-to-r', 'from-blue-600', 'to-blue-500', 'text-white');
                
                document.getElementById('mobileExamTab').classList.remove('bg-gradient-to-r', 'from-purple-600', 'to-purple-500', 'text-white');
                document.getElementById('mobileExamTab').classList.add('bg-gray-100', 'text-gray-800');
                
                // Close mobile menu
                document.getElementById('mobileMenu').classList.remove('open');
            } else {
                document.getElementById('monthlyForm').classList.add('hidden');
                document.getElementById('examForm').classList.remove('hidden');
                document.getElementById('receiptPreviewSection').classList.add('hidden');
                
                document.getElementById('examTab').classList.remove('bg-gray-100', 'text-gray-800');
                document.getElementById('examTab').classList.add('bg-gradient-to-r', 'from-purple-600', 'to-purple-500', 'text-white');
                
                document.getElementById('monthlyTab').classList.remove('bg-gradient-to-r', 'from-blue-600', 'to-blue-500', 'text-white');
                document.getElementById('monthlyTab').classList.add('bg-gray-100', 'text-gray-800');
                
                // For mobile
                document.getElementById('mobileExamTab').classList.remove('bg-gray-100', 'text-gray-800');
                document.getElementById('mobileExamTab').classList.add('bg-gradient-to-r', 'from-purple-600', 'to-purple-500', 'text-white');
                
                document.getElementById('mobileMonthlyTab').classList.remove('bg-gradient-to-r', 'from-blue-600', 'to-blue-500', 'text-white');
                document.getElementById('mobileMonthlyTab').classList.add('bg-gray-100', 'text-gray-800');
                
                // Close mobile menu
                document.getElementById('mobileMenu').classList.remove('open');
            }
        }
        
        document.getElementById('monthlyTab').addEventListener('click', () => switchTab('monthly'));
        document.getElementById('examTab').addEventListener('click', () => switchTab('exam'));
        document.getElementById('mobileMonthlyTab').addEventListener('click', () => switchTab('monthly'));
        document.getElementById('mobileExamTab').addEventListener('click', () => switchTab('exam'));
        
        // Set today's date as default
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('receiptDate').value = today;
            document.getElementById('examDate').value = today;
            
            // Load recent receipts from localStorage
            loadRecentReceipts();
        });
        
        // Invoice number tracking using localStorage
        function getNextInvoiceNumber(type) {
            const now = new Date();
            const year = now.getFullYear();
            const key = `${type}_${year}`;
            
            let lastNumber = localStorage.getItem(key);
            if (!lastNumber) {
                lastNumber = 0;
            } else {
                lastNumber = parseInt(lastNumber);
            }
            
            const nextNumber = lastNumber + 1;
            localStorage.setItem(key, nextNumber.toString());
            
            return nextNumber.toString().padStart(3, '0');
        }
        
        // Save receipt to recent receipts
        function saveRecentReceipt(type, studentName, amount, date) {
            const receipts = JSON.parse(localStorage.getItem('recentReceipts') || '[]');
            
            // Limit to 5 recent receipts
            if (receipts.length >= 5) {
                receipts.pop();
            }
            
            receipts.unshift({
                type: type,
                studentName: studentName,
                amount: amount,
                date: date,
                timestamp: new Date().getTime()
            });
            
            localStorage.setItem('recentReceipts', JSON.stringify(receipts));
            loadRecentReceipts();
        }
        
        // Load recent receipts
        function loadRecentReceipts() {
            const receipts = JSON.parse(localStorage.getItem('recentReceipts') || '[]');
            const container = document.getElementById('recentReceipts');
            
            if (receipts.length === 0) {
                container.innerHTML = '<p class="text-gray-500 italic">No recent receipts yet</p>';
                return;
            }
            
            let html = '';
            receipts.forEach(receipt => {
                const formattedDate = new Date(receipt.date).toLocaleDateString('en-IN', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });
                
                const typeClass = receipt.type === 'monthly' ? 'bg-blue-100 text-blue-800' : 'bg-purple-100 text-purple-800';
                const typeIcon = receipt.type === 'monthly' ? 'fa-calendar-alt' : 'fa-medal';
                
                html += `
                    <div class="p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition duration-200">
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-medium">${receipt.studentName}</p>
                                <p class="text-xs text-gray-500">${formattedDate}</p>
                            </div>
                            <span class="px-2 py-1 rounded-full text-xs font-medium ${typeClass}">
                                <i class="fas ${typeIcon} mr-1"></i> ₹${receipt.amount.toFixed(2)}
                            </span>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // Generate Monthly Receipt
        document.getElementById('generateMonthlyReceipt').addEventListener('click', function() {
            const studentName = document.getElementById('studentName').value;
            const receiptDate = document.getElementById('receiptDate').value;
            const monthlyFee = parseFloat(document.getElementById('monthlyFee').value) || 0;
            const admissionFee = parseFloat(document.getElementById('admissionFee').value) || 0;
            const otherCharges = parseFloat(document.getElementById('otherCharges').value) || 0;
            const notes = document.getElementById('notes').value;
            
            if (!studentName || !receiptDate) {
                showToast('Please fill in all required fields', 'error');
                return;
            }
            
            const totalAmount = monthlyFee + admissionFee + otherCharges;
            const invoiceNumber = `INV-${new Date().getFullYear()}-${getNextInvoiceNumber('INV')}`;
            
            const formattedDate = new Date(receiptDate).toLocaleDateString('en-IN', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
            
            const receiptHTML = `
                <div class="max-w-2xl mx-auto">
                    <div class="text-center mb-8">
                        <p class="text-sm font-medium text-gray-600 mb-2">Registration No: PU000121240</p>
                        <div class="flex justify-center mb-4">
                            <div class="w-16 h-16 rounded-full bg-red-600 flex items-center justify-center shadow-lg">
                                <i class="fas fa-lion text-white text-3xl"></i>
                            </div>
                        </div>
                        <h1 class="text-3xl font-bold">Lions Karate Club Pune</h1>
                        <p class="text-sm text-gray-600 mt-1">Phone: 9049688172 | Pune, Maharashtra</p>
                    </div>
                    
                    <div class="flex justify-between mb-8">
                        <div>
                            <p class="text-sm"><span class="font-semibold">Invoice No:</span> ${invoiceNumber}</p>
                            <p class="text-sm"><span class="font-semibold">Date:</span> ${formattedDate}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-semibold">Student Name:</p>
                            <p class="text-sm">${studentName}</p>
                        </div>
                    </div>
                    
                    <table class="w-full border-collapse mb-8">
                        <thead>
                            <tr class="bg-gray-700 text-gray-100">
                                <th class="py-3 px-4 text-left">Description</th>
                                <th class="py-3 px-4 text-right">Amount (₹)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${monthlyFee > 0 ? `
                            <tr class="striped-row border-b border-gray-700">
                                <td class="py-3 px-4 font-bold text-gray-900">Monthly Fee</td>
                                <td class="py-3 px-4 text-right font-bold text-gray-900">${monthlyFee.toFixed(2)}</td>
                            </tr>
                            ` : ''}
                            ${admissionFee > 0 ? `
                            <tr class="striped-row border-b border-gray-200">
                                <td class="py-3 px-4 font-bold text-gray-900">Admission Fee</td>
                                <td class="py-3 px-4 text-right font-bold text-gray-900">${admissionFee.toFixed(2)}</td>
                            </tr>
                            ` : ''}
                            ${otherCharges > 0 ? `
                            <tr class="striped-row border-b border-gray-200">
                                <td class="py-3 px-4 font-bold text-gray-900">Other Charges</td>
                                <td class="py-3 px-4 text-right font-bold text-gray-900">${otherCharges.toFixed(2)}</td>
                            </tr>
                            ` : ''}
                            <tr class="bg-gray-800">
                                <td class="py-3 px-4 font-bold text-white">Total Amount</td>
                                <td class="py-3 px-4 text-right font-bold text-white">₹${totalAmount.toFixed(2)}</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    ${notes ? `
                    <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                        <p class="text-sm font-semibold text-blue-800">Notes:</p>
                        <p class="text-sm text-blue-700">${notes}</p>
                    </div>
                    ` : ''}
                    
                    <div class="mt-12 pt-6 border-t border-gray-200 text-center text-sm text-gray-600">
                        <p>Thank you for your payment!</p>
                        <p class="mt-2">Generated by Lions Karate Club Bill Generator</p>
                        <p class="mt-1 text-xs">${new Date().toLocaleString()}</p>
                    </div>
                </div>
            `;
            
            document.getElementById('receiptPreview').innerHTML = receiptHTML;
            document.getElementById('receiptPreviewSection').classList.remove('hidden');
            
            // Save to recent receipts
            saveRecentReceipt('monthly', studentName, totalAmount, receiptDate);
            
            // Scroll to preview section
            document.getElementById('receiptPreviewSection').scrollIntoView({ behavior: 'smooth' });
            
            showToast('Receipt generated successfully!');
        });
        
        // Generate Exam Receipt
        document.getElementById('generateExamReceipt').addEventListener('click', function() {
            const studentName = document.getElementById('examStudentName').value;
            const examDate = document.getElementById('examDate').value;
            const appliedBelt = document.getElementById('appliedBelt').value;
            const examFee = parseFloat(document.getElementById('examFee').value) || 0;
            
            if (!studentName || !examDate || !examFee) {
                showToast('Please fill in all required fields', 'error');
                return;
            }
            
            const invoiceNumber = `EXAM-${new Date().getFullYear()}-${getNextInvoiceNumber('EXAM')}`;
            
            const formattedDate = new Date(examDate).toLocaleDateString('en-IN', {
                day: '2-digit',
                month: 'short',
                year: 'numeric'
            });
            
            // Get belt color class
            const beltColorClass = `belt-${appliedBelt.split(' ')[0].toLowerCase()}`;
            
            const receiptHTML = `
                <div class="max-w-2xl mx-auto">
                    <div class="text-center mb-8">
                        <div class="flex justify-center mb-4">
                            <div class="w-16 h-16 rounded-full bg-red-600 flex items-center justify-center shadow-lg">
                                <i class="fas fa-lion text-white text-3xl"></i>
                            </div>
                        </div>
                        <h1 class="text-3xl font-bold">Lions Karate Club Pune</h1>
                        <p class="text-sm text-gray-600 mt-1">Phone: 9049688172 | Pune, Maharashtra</p>
                    </div>
                    
                    <div class="flex justify-between mb-8">
                        <div>
                            <p class="text-sm"><span class="font-semibold">Receipt No:</span> ${invoiceNumber}</p>
                            <p class="text-sm"><span class="font-semibold">Date:</span> ${formattedDate}</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-semibold">Student Name:</p>
                            <p class="text-sm">${studentName}</p>
                        </div>
                    </div>
                    
                    <table class="w-full border-collapse mb-8">
                        <thead>
                            <tr class="bg-gray-800 text-white">
                                <th class="py-3 px-4 text-left">Description</th>
                                <th class="py-3 px-4 text-right">Amount (₹)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="striped-row border-b border-gray-200">
                                <td class="py-3 px-4 font-bold text-gray-900">${appliedBelt} Exam Fee</td>
                                <td class="py-3 px-4 text-right font-bold text-gray-900">${examFee.toFixed(2)}</td>
                            </tr>
                            <tr class="bg-gray-800">
                                <td class="py-3 px-4 font-bold text-white">Total Amount</td>
                                <td class="py-3 px-4 text-right font-bold text-white">₹${examFee.toFixed(2)}</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="mt-6 p-4 bg-purple-50 rounded-lg">
                        <p class="text-sm font-semibold text-purple-800">Exam Details:</p>
                        <div class="flex items-center mt-2">
                            <span class="px-3 py-1 rounded-full text-sm font-medium ${beltColorClass} mr-3">
                                ${appliedBelt}
                            </span>
                            <p class="text-sm text-purple-700">Examination scheduled for ${formattedDate}</p>
                        </div>
                    </div>
                    
                    <div class="mt-12 pt-6 border-t border-gray-200 text-center text-sm text-gray-600">
                        <p>Thank you for your payment!</p>
                        <p class="mt-2">Generated by Lions Karate Club Bill Generator</p>
                        <p class="mt-1 text-xs">${new Date().toLocaleString()}</p>
                    </div>
                </div>
            `;
            
            document.getElementById('receiptPreview').innerHTML = receiptHTML;
            document.getElementById('receiptPreviewSection').classList.remove('hidden');
            
            // Save to recent receipts
            saveRecentReceipt('exam', studentName, examFee, examDate);
            
            // Scroll to preview section
            document.getElementById('receiptPreviewSection').scrollIntoView({ behavior: 'smooth' });
            
            showToast('Exam receipt generated successfully!');
        });
        
        // Download PDF functionality - Fixed for mobile
        document.getElementById('downloadPdf').addEventListener('click', function() {
            const button = this;
            const originalText = button.innerHTML;
            
            // Show loading state
            button.disabled = true;
            button.innerHTML = '<div class="spinner mr-2"></div> Downloading...';
            
            const element = document.getElementById('receiptPreview');
            
            // Create a promise to handle the PDF generation
            const generatePDF = new Promise((resolve, reject) => {
                try {
                    html2canvas(element, {
                        scale: 2,
                        logging: false,
                        useCORS: true,
                        scrollX: 0,
                        scrollY: 0,
                        windowWidth: element.scrollWidth,
                        windowHeight: element.scrollHeight
                    }).then(canvas => {
                        const imgData = canvas.toDataURL('image/png');
                        const pdf = new jsPDF('p', 'mm', 'a4');
                        const imgWidth = 210; // A4 width in mm
                        const pageHeight = 295; // A4 height in mm
                        const imgHeight = canvas.height * imgWidth / canvas.width;
                        let heightLeft = imgHeight;
                        let position = 0;
                        
                        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                        
                        while (heightLeft >= 0) {
                            position = heightLeft - imgHeight;
                            pdf.addPage();
                            pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                            heightLeft -= pageHeight;
                        }
                        
                        // Generate filename based on receipt type
                        let filename = 'receipt.pdf';
                        if (document.getElementById('monthlyForm').classList.contains('hidden')) {
                            filename = `belt_exam_${document.getElementById('examStudentName').value.replace(/\s+/g, '_')}.pdf`;
                        } else {
                            filename = `monthly_fee_${document.getElementById('studentName').value.replace(/\s+/g, '_')}.pdf`;
                        }
                        
                        // For mobile devices, we need to use a different approach
                        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                            // Create a blob and download it
                            const pdfBlob = pdf.output('blob');
                            const blobUrl = URL.createObjectURL(pdfBlob);
                            
                            // Create a temporary anchor element
                            const a = document.createElement('a');
                            a.href = blobUrl;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            
                            // Clean up
                            setTimeout(() => {
                                document.body.removeChild(a);
                                URL.revokeObjectURL(blobUrl);
                            }, 100);
                        } else {
                            // For desktop, use the normal save method
                            pdf.save(filename);
                        }
                        
                        resolve();
                    }).catch(err => {
                        console.error('Error generating PDF:', err);
                        reject('Error generating PDF');
                    });
                } catch (err) {
                    console.error('Error in PDF generation:', err);
                    reject('Error in PDF generation');
                }
            });
            
            generatePDF.then(() => {
                showToast('PDF downloaded successfully!');
            }).catch((error) => {
                showToast(error || 'Failed to download PDF', 'error');
            }).finally(() => {
                // Restore button state
                button.disabled = false;
                button.innerHTML = originalText;
            });
        });
        
        // Print functionality
        document.getElementById('printReceipt').addEventListener('click', function() {
            const printWindow = window.open('', '', 'width=800,height=600');
            printWindow.document.write('<html><head><title>Print Receipt</title>');
            printWindow.document.write('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">');
            printWindow.document.write('<style>body { font-family: Arial; margin: 0; padding: 20px; }</style>');
            printWindow.document.write('</head><body>');
            printWindow.document.write(document.getElementById('receiptPreview').innerHTML);
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 500);
            
            showToast('Print dialog opened');
        });
        
        // Function to re-attach event listeners after print
        function attachEventListeners() {
            // Re-attach all necessary event listeners here
            document.getElementById('monthlyTab').addEventListener('click', () => switchTab('monthly'));
            document.getElementById('examTab').addEventListener('click', () => switchTab('exam'));
            document.getElementById('mobileMonthlyTab').addEventListener('click', () => switchTab('monthly'));
            document.getElementById('mobileExamTab').addEventListener('click', () => switchTab('exam'));
            document.getElementById('generateMonthlyReceipt').addEventListener('click', generateMonthlyReceipt);
            document.getElementById('generateExamReceipt').addEventListener('click', generateExamReceipt);
            document.getElementById('downloadPdf').addEventListener('click', downloadPdf);
            document.getElementById('printReceipt').addEventListener('click', printReceipt);
            document.getElementById('mobileMenuToggle').addEventListener('click', toggleMobileMenu);
        }
    </script>
</body>
</html>
